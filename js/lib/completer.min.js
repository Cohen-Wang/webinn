!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(h){"use strict";var a=h(window),t=h(document),l=function(t,e){this.$element=h(t),this.defaults=h.extend({},l.defaults,this.$element.data(),h.isPlainObject(e)?e:{}),this.init()},u=function(t){return t.replace(/([\.\$\^\{\[\(\|\)\*\+\?\\])/g,"\\$1")};l.prototype={constructor:l,init:function(){var t,e,s=this.defaults,i=("string"==typeof(t=s.source)&&(t=t.replace(/[\{\}\[\]"']+/g,"").split(/\s*,+\s*/)),h.map(t,function(t){return"string"!=typeof t?t.toString():t}));0<i.length&&(this.data=i,this.regexp="string"==typeof(e=s.separator)&&""!==e?(e=u(e),new RegExp(e+"+[^"+e+"]*$","i")):null,this.$completer=h(s.template),this.$completer.hide().appendTo("body"),this.place(),this.$element.attr("autocomplete","off").on({focus:h.proxy(this.enable,this),blur:h.proxy(this.disable,this)}),this.$element.is(":focus")&&this.enable())},enable:function(){this.active||(this.active=!0,this.$element.on({keydown:h.proxy(this.keydown,this),keyup:h.proxy(this.keyup,this)}),this.$completer.on({mousedown:h.proxy(this.mousedown,this),mouseover:h.proxy(this.mouseover,this)}))},disable:function(){this.active&&(this.active=!1,this.$element.off({keydown:this.keydown,keyup:this.keyup}),this.$completer.off({mousedown:this.mousedown,mouseover:this.mouseover}))},attach:function(s){var i,o,n=this.defaults.separator,t=this.regexp,e=t?s.match(t):null,l=[],a=[],r=this;e&&(e=e[0],s=s.replace(t,""),i=new RegExp("^"+u(e),"i")),h.each(this.data,function(t,e){e=n+e,o=r.template(s+e),i&&i.test(e)?l.push(o):a.push(o)}),l=l.length?l.sort():a,"top"===this.defaults.position&&(l=l.reverse()),this.fill(l.join(""))},suggest:function(s){var i=new RegExp(u(s),"i"),o=this,n=[];h.each(this.data,function(t,e){i.test(e)&&n.push(e)}),n.sort(function(t,e){return t.indexOf(s)-e.indexOf(s)}),h.each(n,function(t,e){n[t]=o.template(e)}),this.fill(n.join(""))},template:function(t){var e=this.defaults.itemTag;return"<"+e+">"+t+"</"+e+">"},fill:function(t){var e;this.$completer.empty(),t?(e="top"===this.defaults.position?":last":":first",this.$completer.html(t),this.$completer.children(e).addClass(this.defaults.selectedClass),this.show()):this.hide()},complete:function(){var t=this.defaults,e=t.filter(this.$element.val()).toString();return""===e?void this.hide():void(t.suggest?this.suggest(e):this.attach(e))},keydown:function(t){13===t.keyCode&&(t.stopPropagation(),t.preventDefault())},keyup:function(t){var e=t.keyCode;13===e||38===e||40===e?this.toggle(e):this.complete()},mouseover:function(t){var e=this.defaults,s=e.selectedClass,i=h(t.target);i.is(e.itemTag)&&i.addClass(s).siblings().removeClass(s)},mousedown:function(t){t.stopPropagation(),t.preventDefault(),this.setValue(h(t.target).text())},setValue:function(t){this.$element.val(t),this.defaults.complete(),this.hide()},toggle:function(t){var e=this.defaults.selectedClass,s=this.$completer.find("."+e);switch(t){case 40:s.removeClass(e),s=s.next();break;case 38:s.removeClass(e),s=s.prev();break;case 13:this.setValue(s.text())}0===s.length&&(s=this.$completer.children(40===t?":first":":last")),s.addClass(e)},place:function(){var t=this.$element,e=t.offset(),s=e.left,i=e.top,o=t.outerHeight(),n=t.outerWidth(),l={minWidth:n,zIndex:this.defaults.zIndex};switch(this.defaults.position){case"right":l.left=s+n,l.top=i;break;case"left":l.right=a.innerWidth()-s,l.top=i;break;case"top":l.left=s,l.bottom=a.innerHeight()-i;break;default:l.left=s,l.top=i+o}this.$completer.css(l)},show:function(){this.$completer.show(),a.on("resize",h.proxy(this.place,this)),t.on("mousedown",h.proxy(this.hide,this))},hide:function(){this.$completer.hide(),a.off("resize",this.place),t.off("mousedown",this.hide)},destroy:function(){this.hide(),this.disable(),this.$element.off({focus:this.enable,blur:this.disable})}},l.defaults={itemTag:"li",position:"bottom",source:[],selectedClass:"completer-selected",separator:"",suggest:!1,template:'<ul class="completer-container"></ul>',zIndex:1,complete:h.noop,filter:function(t){return t}},l.setDefaults=function(t){h.extend(l.defaults,t)},h.fn.completer=function(i){var o,n=[].slice.call(arguments,1);return this.each(function(){var t,e=h(this),s=e.data("completer");s||e.data("completer",s=new l(this,i)),"string"==typeof i&&h.isFunction(t=s[i])&&(o=t.apply(s,n))}),void 0!==o?o:this},h.fn.completer.Constructor=l,h.fn.completer.setDefaults=l.setDefaults,h(function(){h('[data-toggle="completer"],[completer]').completer()})});